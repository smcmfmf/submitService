<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³¼ì œ ì œì¶œ - ê³¼ì œ ì œì¶œ ì‹œìŠ¤í…œ</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        /* íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ ìŠ¤íƒ€ì¼ ìˆ˜ì • */
        .file-upload-area {
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius);
            padding: 20px; /* ê¸°ì¡´ 40pxì—ì„œ ì¤„ì„ */
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex; /* ê°€ë¡œ ë°°ì¹˜ë¥¼ ìœ„í•´ flex ì‚¬ìš© */
            align-items: center;
            justify-content: center;
            gap: 15px; /* ì•„ì´ì½˜ê³¼ í…ìŠ¤íŠ¸ ì‚¬ì´ ê°„ê²© */
        }
        .file-upload-area:hover {
            border-color: var(--primary-color);
            background-color: #f9fafb;
        }
        /* ì•„ì´ì½˜ í¬ê¸° ì¤„ì„ */
        .file-upload-area i {
            font-size: 1.8em; /* ê¸°ì¡´ 3emì—ì„œ ì¤„ì„ */
            color: var(--text-light-color);
            transition: color 0.3s ease;
        }
        .file-upload-area:hover i {
            color: var(--primary-color);
        }
        .file-upload-area p {
            margin: 0;
            font-weight: 500;
            font-size: 1.1em;
        }
        input[type="file"] {
            display: none;
        }
    </style>
</head>
<body>

<div class="header">
    <h1><i class="fas fa-upload"></i> ê³¼ì œ ì œì¶œ</h1>
    <nav class="header-nav">
        <a th:href="@{/student/course/{courseId}(courseId=${assignment.course.courseId})}"><i class="fas fa-arrow-left"></i> ê³¼ì œ ëª©ë¡ìœ¼ë¡œ</a>
    </nav>
</div>

<div class="container form-container">
    <div class="card">
        <div class="page-header" style="text-align: center;">
            <h2 class="page-title" th:text="${assignment.title}">ê³¼ì œ ì œëª©</h2>
            <p class="page-subtitle" th:text="'ë§ˆê°ì¼: ' + ${#temporals.format(assignment.deadline, 'yyyyë…„ MMì›” ddì¼ HH:mm')}"></p>
        </div>

        <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
        <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

        <div th:if="${existingSubmission != null and existingSubmission.isGraded}" class="alert alert-danger">
            <strong>ğŸ”’ í‰ê°€ ì™„ë£Œ</strong>
            <p style="margin: 5px 0 0;">ì´ ê³¼ì œëŠ” í‰ê°€ê°€ ì™„ë£Œë˜ì–´ ë” ì´ìƒ ì œì¶œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
            <a th:href="@{/student/assignment/{id}/my-submission(id=${assignment.assignmentId})}" class="btn btn-info" style="margin-top: 15px;">ë‚´ ì œì¶œë¬¼ í™•ì¸</a>
        </div>

        <div th:if="${existingSubmission == null or !existingSubmission.isGraded}">
            <div th:if="${existingSubmission != null}" class="alert alert-warning">
                <strong>ğŸ”„ ì¬ì œì¶œ ì•ˆë‚´</strong>
                <p style="margin: 5px 0 0;">ìƒˆë¡œìš´ íŒŒì¼ì„ ì œì¶œí•˜ë©´ ê¸°ì¡´ íŒŒì¼ì´ ëŒ€ì²´ë©ë‹ˆë‹¤.</p>
            </div>

            <form th:action="@{/student/assignment/{assignmentId}/submit(assignmentId=${assignment.assignmentId})}"
                  method="post" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="file" class="form-label">ì œì¶œ íŒŒì¼</label>
                    <label for="file" class="file-upload-area">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p id="file-name">íŒŒì¼ì„ ì„ íƒí•˜ë ¤ë©´ ì—¬ê¸°ë¥¼ í´ë¦­í•˜ì„¸ìš”</p>
                    </label>
                    <input type="file" id="file" name="file" required>
                    <p class="form-help-text">ì œì¶œí•  ê³¼ì œ íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</p>
                </div>
                <div class="form-actions">
                    <a th:href="@{/student/course/{courseId}(courseId=${assignment.course.courseId})}" class="btn btn-secondary">ì·¨ì†Œ</a>
                    <button type="submit" class="btn btn-primary" th:text="${existingSubmission != null} ? 'ì¬ì œì¶œí•˜ê¸°' : 'ì œì¶œí•˜ê¸°'"></button>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    const fileInput = document.getElementById('file');
    const fileNameDisplay = document.getElementById('file-name');
    if (fileInput) {
        fileInput.addEventListener('change', () => {
            fileNameDisplay.textContent = fileInput.files[0] ? fileInput.files[0].name : 'íŒŒì¼ì„ ì„ íƒí•˜ë ¤ë©´ ì—¬ê¸°ë¥¼ í´ë¦­í•˜ì„¸ìš”';
        });
    }
</script>
</body>
</html>