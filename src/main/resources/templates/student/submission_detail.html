<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>제출물 상세 - 과제 제출 시스템</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<div class="header">
    <h1><i class="fas fa-file-signature"></i> 제출물 상세</h1>
    <nav class="header-nav">
        <a th:href="@{/student/course/{id}(id=${assignment.course.courseId})}"><i class="fas fa-arrow-left"></i> 과제 목록으로</a>
    </nav>
</div>

<div class="container">
    <div class="card">
        <div class="section-header">
            <h2><i class="fas fa-book-reader"></i> 과제 정보</h2>
        </div>
        <h3 th:text="${assignment.title}" style="font-size:1.8em; margin-top:0;"></h3>
        <p th:text="${assignment.description}" style="color:var(--text-light-color);"></p>
        <div class="alert alert-info" th:text="'마감일: ' + ${#temporals.format(assignment.deadline, 'yyyy년 MM월 dd일 HH:mm')}"></div>
    </div>

    <div th:if="${submission}">
        <div class="card">
            <div class="section-header">
                <h2><i class="fas fa-paper-plane"></i> 내 제출 정보</h2>
            </div>
            <p><strong>제출일:</strong> <span th:text="${#temporals.format(submission.submittedAt, 'yyyy년 MM월 dd일 HH:mm')}"></span></p>
            <a th:href="${submission.fileUrl}" class="btn btn-secondary"><i class="fas fa-download"></i> 제출한 파일 다운로드</a>
        </div>

        <div class="card">
            <div class="section-header">
                <h2><i class="fas fa-check-circle"></i> 채점 결과</h2>
            </div>
            <div th:if="${submission.isGraded}" class="alert alert-success">
                <h4>🔒 평가 완료</h4>
                <p style="font-size: 2em; font-weight: 700;" th:text="${submission.grade} + '점'"></p>
                <p>평가가 최종 완료되어 재제출할 수 없습니다.</p>
            </div>
            <div th:if="${submission.grade != null and !submission.isGraded}" class="alert alert-warning">
                <h4>✅ 채점 완료 (임시)</h4>
                <p style="font-size: 2em; font-weight: 700;" th:text="${submission.grade} + '점'"></p>
                <p>교수님께서 아직 최종 평가를 완료하지 않았습니다. 재제출이 가능합니다.</p>
            </div>
            <div th:unless="${submission.grade != null}" class="alert alert-info">
                <h4>⏳ 채점 대기 중</h4>
                <p>교수님의 채점을 기다리고 있습니다.</p>
            </div>

            <div th:if="${submission.feedback}" style="margin-top:20px;">
                <h4><i class="fas fa-comment-dots"></i> 교수님 피드백</h4>
                <p th:text="${submission.feedback}" style="white-space: pre-line; background-color:#f8f9fa; padding:15px; border-radius:8px;"></p>
            </div>

            <div th:unless="${submission.isGraded}" style="margin-top: 25px;">
                <a th:href="@{/student/assignment/{id}/submit(id=${assignment.assignmentId})}" class="btn btn-primary">🔄 과제 재제출하기</a>
            </div>
        </div>

    </div>

    <div th:unless="${submission}" class="card">
        <div class="section-header">
            <h2><i class="fas fa-exclamation-triangle"></i> 제출 내역 없음</h2>
        </div>
        <p>아직 이 과제를 제출하지 않았습니다.</p>
        <a th:href="@{/student/assignment/{id}/submit(id=${assignment.assignmentId})}" class="btn btn-primary">지금 제출하기</a>
    </div>
</div>

</body>
</html>